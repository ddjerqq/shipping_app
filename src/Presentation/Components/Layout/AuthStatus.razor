@using Application.Common
@using Domain.Common
@using Presentation.Components.Ui.Avatar
@inject CookieService Cookie

<AuthorizeView>
    <Button Variant="outline" Class="flex-shrink-0" data-dropdown-toggle="dropdown">
        <span>
            @context.User.GetUsername()
        </span>

        <Avatar Class="size-6">
            <AvatarImage Src="@(context.User.GetAvatar())" Alt="@(context.User.GetUsername())"/>
            <AvatarFallback>
                @context.User.GetUsername()?.Initials()
            </AvatarFallback>
        </Avatar>
    </Button>

    <div id="dropdown" class="z-10 hidden divide-y divide-background-100 rounded-lg shadow w-44 border bg-background">
        <div class="px-4 py-3 text-sm">
            <div>@context.User.GetUsername()</div>
            <div class="font-medium truncate">@context.User.GetEmail()</div>
        </div>

        <ul class="py-2 text-sm text-background-200">
            <li>
                @* <Button Href="me"></Button> *@
                <a href="me" class="block px-4 py-2 hover:bg-gray-200 hover:text-black">Settings</a>
                <a href="me" class="block px-4 py-2 hover:bg-gray-200 hover:text-black">Settings</a>
                <a href="me" class="block px-4 py-2 hover:bg-gray-200 hover:text-black">Settings</a>
                <a href="me" class="block px-4 py-2 hover:bg-gray-200 hover:text-black">Settings</a>
            </li>
        </ul>

        <div class="py-2">
            <a @onclick="SignOut" class="block px-4 py-2 text-sm hover:bg-destructive text-destructive hover:text-white">
                Sign out
            </a>
        </div>
    </div>
</AuthorizeView>


@code {
    private async Task SignOut()
    {
        await Cookie.DeleteCookieAsync(JwtGenerator.CookieName);
        NavigationManager.NavigateTo("/login");
    }
}