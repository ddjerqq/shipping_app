@page "/calculate"
@using Application.Cqrs.Packages.Commands
@attribute [AllowAnonymous]

<PageTitle>@Locale.calculator</PageTitle>
<PageHeader Title="@Locale.calculator"/>

<Card class="mt-4">
    <Header>
        <Description>@Locale.calculator_description</Description>
    </Header>

    <Content>
        <AppForm @bind-Model="Command">
            <FormField>
                <FormLabel for="weight">@Locale.weight (KG)</FormLabel>
                <InputNumber id="weight"
                             class="@FormInputText.BaseClass"
                             @bind-Value="@Command.WeightKiloGrams"
                             type="number"
                             min="0"
                             step="100"
                             max="1000"
                             required
                             disabled="@IsLoading"/>
                <FormDescription class="text-xs">
                    @Locale.please_keep_in_mind_the_weight_will_get_rounded_up_to_the_nearest_100_grams
                </FormDescription>
                <FormInvalidFeedback For="@(() => Command.WeightKiloGrams)"/>
            </FormField>

            <InlineFormFieldContainer class="mt-2 sm:grid-cols-3">
                <FormField>
                    <FormLabel for="y">Width (cm)</FormLabel>
                    <InputNumber id="y"
                                 class="@FormInputText.BaseClass"
                                 @bind-Value="@Command.Width"
                                 type="number"
                                 step="0.1"
                                 min="0"
                                 max="100"
                                 disabled="@IsLoading"/>
                    <FormInvalidFeedback For="@(() => Command.Width)"/>
                </FormField>

                <FormField>
                    <FormLabel for="z">Height (cm)</FormLabel>
                    <InputNumber id="z"
                                 class="@FormInputText.BaseClass"
                                 @bind-Value="@Command.Height"
                                 type="number"
                                 step="0.1"
                                 min="0"
                                 max="100"
                                 disabled="@IsLoading"/>
                    <FormInvalidFeedback For="@(() => Command.Height)"/>
                </FormField>

                <FormField>
                    <FormLabel for="x">Length (cm)</FormLabel>
                    <InputNumber id="x"
                                 class="@FormInputText.BaseClass"
                                 @bind-Value="@Command.Length"
                                 type="number"
                                 step="0.1"
                                 min="0"
                                 max="100"
                                 disabled="@IsLoading"/>
                    <FormInvalidFeedback For="@(() => Command.Length)"/>
                </FormField>

                <FormDescription class="col-span-3">
                    @Locale.calculator_volumetric_notice
                    <Link Href="/faq" Title="@Locale.faq"/>
                </FormDescription>
            </InlineFormFieldContainer>

            <FormField>
                <FormLabel for="house-delivery">@Locale.house_delivery?</FormLabel>
                <Switch id="house-delivery"
                        @bind-Value="@Command.IsHouseDelivery"
                        disabled="@IsLoading"/>
                <FormDescription>
                    @Locale.calculator_price_notice
                    <Link Href="/faq" Title="@Locale.faq"/>
                </FormDescription>
            </FormField>
        </AppForm>
    </Content>

    <Footer class="grid gap-2 grid-cols-2">
        @if (Command.VolumetricApplied)
        {
            <FormField class="pointer-events-none">
                <FormLabel for="volumetric-price">@Locale.volumetric_price</FormLabel>
                <FormInputMoney Id="volumetric-price" Value="Command.VolumetricPrice"/>
            </FormField>
        }

        <FormField class="pointer-events-none">
            <FormLabel for="total-price">@Locale.total_price</FormLabel>
            <FormInputMoney Id="total-price" Value="Command.Price"/>
        </FormField>
    </Footer>
</Card>

@code {
    private CalculatePriceCommand Command { get; set; } = new();
}