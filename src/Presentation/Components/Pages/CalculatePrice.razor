@page "/calculate"
@using Application.Cqrs.Packages.Commands
@using Presentation.Components.Layout
@using Presentation.Components.Shared
@using Presentation.Components.Ui.Form
@using Presentation.Components.Ui.Form.Inputs
@attribute [AllowAnonymous]
@layout AuthLayout

<PageTitle>Calculate package price</PageTitle>

<PageHeader
    Title="Calculate the price for your package"
    Description="Enter the required parameters of the parcel and the calculator will calculate the cost of the delivery"/>

<AppForm @bind-Model="Command" novalidate class="grid gap-6">
    <FormField>
        <FormLabel for="weight">Weight (KG)</FormLabel>
        <InputNumber id="weight"
                     class="@FormInputText.BaseClass"
                     @bind-Value="@Command.WeightKiloGrams"
                     type="number"
                     min="0"
                     step="100"
                     max="1000"
                     required
                     disabled="@IsLoading"/>
        <FormDescription Class="text-xs">
            Please keep in mind, the weight will get rounded up to the nearest 100 grams.
        </FormDescription>
        <FormInvalidFeedback For="@(() => Command.WeightKiloGrams)"/>
    </FormField>

    <details class="cursor-pointer">
        <summary>Enter dimensions</summary>
        <InlineFormFieldContainer Class="mt-2 sm:grid-cols-3">
            <FormField>
                <FormLabel for="x">Length (cm)</FormLabel>
                <InputNumber id="x"
                             class="@FormInputText.BaseClass"
                             @bind-Value="@Command.Length"
                             type="number"
                             step="0.1"
                             min="0"
                             max="100"
                             disabled="@IsLoading"/>
                <FormInvalidFeedback For="@(() => Command.Length)"/>
            </FormField>

            <FormField>
                <FormLabel for="y">Width (cm)</FormLabel>
                <InputNumber id="y"
                             class="@FormInputText.BaseClass"
                             @bind-Value="@Command.Width"
                             type="number"
                             step="0.1"
                             min="0"
                             max="100"
                             disabled="@IsLoading"/>
                <FormInvalidFeedback For="@(() => Command.Width)"/>
            </FormField>

            <FormField>
                <FormLabel for="z">Height (cm)</FormLabel>
                <InputNumber id="z"
                             class="@FormInputText.BaseClass"
                             @bind-Value="@Command.Height"
                             type="number"
                             step="0.1"
                             min="0"
                             max="100"
                             disabled="@IsLoading"/>
                <FormInvalidFeedback For="@(() => Command.Height)"/>
            </FormField>
        </InlineFormFieldContainer>
        <FormDescription>
            To find out more about volumetric weight and how it's calculated please visit our <Link Href="/faq" Title="FAQ"/>
        </FormDescription>
    </details>

    @if (Command.VolumetricApplied)
    {
        <FormField Class="pointer-events-none">
            <FormLabel for="volumetric-price">Volumetric price</FormLabel>
            <FormInputMoney Id="volumetric-price" Value="Command.VolumetricPrice"/>
        </FormField>
    }

    <FormField Class="pointer-events-none">
        <FormLabel for="total-price">Total price</FormLabel>
        <FormInputMoney Id="total-price" Value="Command.Price"/>
    </FormField>
</AppForm>

@code {
    private CalculatePriceCommand Command { get; set; } = new();
}