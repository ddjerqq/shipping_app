@layout EmailLayout
@using Domain.Aggregates
@using Domain.Common
@using Domain.ValueObjects
@using Microsoft.AspNetCore.Components.Sections
@inherits ComponentBase

<SectionContent SectionId="EmailLayout.TitleSectionId">
    @Emails.your_package_has_status: @StatusText
</SectionContent>

<hr style="border:none;border-top:1px solid #eaeaea;margin:26px 0;width:100%;"/>

<EmailParagraph>
    @Emails.your_package_with_the_tracking_code: <br/>
    @Package.TrackingCode<br/>
    @StatusText <br/>
    Date: @(Package.Statuses
               .First(x => x.Status == Status)
               .Date.ToString("dddd, dd MMMM yyyy, HH:mm UTCzzz", Package.Owner.CultureInfo))
</EmailParagraph>

<EmailCta Href="@($"https://{WebAppDomain}/packages/{Package.Id}")" Title="Your package" target="_blank"/>

@code {
    private static string WebAppDomain => "WEB_APP__DOMAIN".FromEnvRequired();

    private string StatusText => Status switch
    {
        PackageStatus.Awaiting => Emails.is_awaiting_arrival_in_our_warehouse,
        PackageStatus.InWarehouse => Emails.has_arrived_at_our_warehouse,
        PackageStatus.InTransit => Emails.has_been_sent,
        PackageStatus.Arrived => Emails.has_arrived,
        PackageStatus.Delivered => Emails.has_been_delivered,
        _ => throw new ArgumentOutOfRangeException(),
    };

    [Parameter]
    public PackageStatus Status { get; set; }

    [Parameter]
    public Package Package { get; set; } = null!;
}
